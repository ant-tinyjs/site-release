/*!
 * Name: tinyjs-plugin-dust
 * Description: Dust is a quick and easy particle effects engine
 * Author: yiiqii
 * Version: v0.3.0
 */
!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e.Tiny=e.Tiny||{},e.Tiny.Dust=i())}(this,function(){"use strict";var e=function(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,i){for(var t=0;t<i.length;t++){var a=i[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(i,t,a){return t&&e(i.prototype,t),a&&e(i,a),i}}(),t=function(){function t(i,a,n,s,l){if(e(this,t),this.x=i||0,this.y=a||0,this.spriteFn=n,this.container=s||new Tiny.Container,!n)throw new Error("Sprite is needed.");l=l||{},this.number=l.number||20,this.gravity=l.gravity||0,this.randomSpacing=!!Tiny.isUndefined(l.randomSpacing)||l.randomSpacing,this.minAngle=l.minAngle||0,this.maxAngle=l.maxAngle||6.28,this.minSize=l.minSize||4,this.maxSize=l.maxSize||16,this.minSpeed=l.minSpeed||.3,this.maxSpeed=l.maxSpeed||3,this.minScaleSpeed=l.minScaleSpeed||.01,this.maxScaleSpeed=l.maxScaleSpeed||.05,this.minAlphaSpeed=l.minAlphaSpeed||.02,this.maxAlphaSpeed=l.maxAlphaSpeed||.02,this.minRotationSpeed=l.minRotationSpeed||.01,this.maxRotationSpeed=l.maxRotationSpeed||.03,this.particles=[],this.angles=[];var o=this,r=void 0,h=(this.maxAngle-this.minAngle)/(this.number-1);t.globalParticles.push(this.particles);for(var p=0;p<this.number;p++)this.randomSpacing?(r=Tiny.randomFloat(this.minAngle,this.maxAngle),this.angles.push(r)):(void 0===r&&(r=this.minAngle),this.angles.push(r),r+=h);this.angles.forEach(function(e){return o.makeParticle(e)})}return i(t,[{key:"makeParticle",value:function(e){var i=this.spriteFn(),t=this.gravity,a=this.particles,n=this.container;i.totalFrames>0&&i.gotoAndStop(Tiny.randomInt(0,i.totalFrames-1));var s=Tiny.randomInt(this.minSize,this.maxSize);i.width=s,i.height=s,i.x=this.x,i.y=this.y,i.scaleSpeed=Tiny.randomFloat(this.minScaleSpeed,this.maxScaleSpeed),i.alphaSpeed=Tiny.randomFloat(this.minAlphaSpeed,this.maxAlphaSpeed),i.rotationSpeed=Tiny.randomFloat(this.minRotationSpeed,this.maxRotationSpeed);var l=Tiny.randomFloat(this.minSpeed,this.maxSpeed);i.vx=l*Math.cos(e),i.vy=l*Math.sin(e),a.push(i),n.addChild(i),i.updateParticle=function(){i.vy+=t,i.x+=i.vx,i.y+=i.vy,i.scale.x-i.scaleSpeed>0&&(i.scale.x-=i.scaleSpeed),i.scale.y-i.scaleSpeed>0&&(i.scale.y-=i.scaleSpeed),i.rotation+=i.rotationSpeed,i.alpha-=i.alphaSpeed,i.alpha<=0&&(n.removeChild(i),a.splice(a.indexOf(i),1))}}},{key:"update",value:function(){if(t.globalParticles.length>0)for(var e=t.globalParticles.length-1;e>=0;e--){var i=t.globalParticles[e];if(i.length>0)for(var a=i.length-1;a>=0;a--){i[a].updateParticle()}else t.globalParticles.splice(t.globalParticles.indexOf(i),1)}}}]),t}();return t.globalParticles=[],t});
