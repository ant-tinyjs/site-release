/*!
 * Name: tinyjs-plugin-ui
 * Description: Tiny.js UI plugin
 * Author: yiiqii
 * Version: v0.7.2
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t.Tiny=t.Tiny||{},t.Tiny.ui={}))}(this,function(t){"use strict";var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},s=function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)},h=function t(){e(this,t),this.width=0,this.height=0,this.active={},this.textStyle={},this.roundRectBase64_black75="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxMzAyZGY2ZS02Y2FmLTQ5YTUtYTVkNS1jM2Q3ZTY1ZGY2YjUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzQwQzQ1MDRDMDRGMTFFN0FFOEE4Qzg3QzREMDc2RjkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzQwQzQ1MDNDMDRGMTFFN0FFOEE4Qzg3QzREMDc2RjkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MTMwMmRmNmUtNmNhZi00OWE1LWE1ZDUtYzNkN2U2NWRmNmI1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjEzMDJkZjZlLTZjYWYtNDlhNS1hNWQ1LWMzZDdlNjVkZjZiNSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PobBPigAAAEFSURBVHjarJXNCgFRGIaP42+j/GysEW6AcBH2UrgyK3EFlNzBhLLAEvlZ2GCPeD99o6HxO99bT02n09M08533uJR9PCDDJEEYnMAOLEAfDHntIS4bWRaUQVS9zxa0WH6P2/KsQQnUQEB9Du0pAB+YgsuzkGRF9XvSwAvGVmEOVNX/IekabDT/gIpyHnJ4NL9dREBIjrzm0ZBKhoQJQWGchEFBYYiEZ0HhbZj3gr4DCZeCwhkJB4LCAQkNbhGnIYehuYIaAkJyHM2zvAF+kPpT1gbd57aZcCX9Oug90LSrL1oYgRWIfdGJVLB10DFlrxrbvAJy3N4xS3nQh59zSxt2V8BVgAEA0AAwNCQbWm0AAAAASUVORK5CYII=",this.roundRectBase64_white="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhBMkZEMEVCQkUxODExRTdBQ0IzRDUwNDhFRTNGQTg4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhBMkZEMEVDQkUxODExRTdBQ0IzRDUwNDhFRTNGQTg4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEEyRkQwRTlCRTE4MTFFN0FDQjNENTA0OEVFM0ZBODgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEEyRkQwRUFCRTE4MTFFN0FDQjNENTA0OEVFM0ZBODgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5j8e8ZAAAA4UlEQVR42qyUXQqCQBRG1cD2UEFQq2gXVtaLq6hd6GstI6j2EQS9RlhQuIXyZfouXGH8K3TuB2cYh7kHZcZrK6WsirjAYyagB1LwBGewB0dey4eEBabgqv6H9syK9fpDB4SqeUKuLQnbyHRpTugr85DDsjHQAdzAwDLLC4wcDAsBGaUPlg5fDal49Ml3TIZCwgcJ35h0hYSpU3nbDULCRNCXkPAiKDyR8CAoPEhf7HF2KGuBt1uBj94cIoP/OKprX5sWsm1d+8qYN2iw/q8Gq+OCAOxADFIm5rWA95RqvwIMAKI2aIgZcds+AAAAAElFTkSuQmCC",this.blankBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM3RDMwODAzQUM4RTExRTc4MDNEQTZGQ0E2MjgxNEFEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM3RDMwODA0QUM4RTExRTc4MDNEQTZGQ0E2MjgxNEFEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MzdEMzA4MDFBQzhFMTFFNzgwM0RBNkZDQTYyODE0QUQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MzdEMzA4MDJBQzhFMTFFNzgwM0RBNkZDQTYyODE0QUQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5Iqam2AAAAEElEQVR42mL4//8/A0CAAQAI/AL+26JNFgAAAABJRU5ErkJggg=="},o=function(t){function i(t,n){e(this,i);var r=a(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return r.setting=new h,r.children=[],r.parent=null,r.stage=null,r.initialized=!1,r.dragInitialized=!1,r.dropInitialized=!1,r.dirty=!0,r.pixelPerfect=!0,r.setting.width=t||0,r.setting.height=n||0,r}return r(i,t),i}(Tiny.Container),u=function(t){function i(){e(this,i);var t=a(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.interactive=!0,t.on("pointerdown",function(t){}),t.on("pointerup",function(t){}),t.on("pointermove",function(t){}),t.on("pointerupoutside",function(t){}),t}return r(i,o),i}();var l=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},d="object"==typeof c&&c&&c.Object===Object&&c,g="object"==typeof self&&self&&self.Object===Object&&self,f=d||g||Function("return this")(),p=function(){return f.Date.now()},b=/\s/;var v=function(t){for(var e=t.length;e--&&b.test(t.charAt(e)););return e},y=/^\s+/;var T=function(t){return t?t.slice(0,v(t)+1).replace(y,""):t},A=f.Symbol,m=Object.prototype,I=m.hasOwnProperty,w=m.toString,x=A?A.toStringTag:void 0;var N=function(t){var e=I.call(t,x),i=t[x];try{t[x]=void 0}catch(t){}var n=w.call(t);return e?t[x]=i:delete t[x],n},E=Object.prototype.toString;var _=function(t){return E.call(t)},M="[object Null]",D="[object Undefined]",k=A?A.toStringTag:void 0;var G=function(t){return null==t?void 0===t?D:M:k&&k in Object(t)?N(t):_(t)};var R=function(t){return null!=t&&"object"==typeof t},j="[object Symbol]";var O=function(t){return"symbol"==typeof t||R(t)&&G(t)==j},Z=NaN,S=/^[-+]0x[0-9a-f]+$/i,W=/^0b[01]+$/i,C=/^0o[0-7]+$/i,H=parseInt;var P=function(t){if("number"==typeof t)return t;if(O(t))return Z;if(l(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=l(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=T(t);var i=W.test(t);return i||C.test(t)?H(t.slice(2),i?2:8):S.test(t)?Z:+t},B="Expected a function",Y=Math.max,Q=Math.min;var F=function(t,e,i){var n,r,a,s,h,o,u=0,c=!1,d=!1,g=!0;if("function"!=typeof t)throw new TypeError(B);function f(e){var i=n,a=r;return n=r=void 0,u=e,s=t.apply(a,i)}function b(t){var i=t-o;return void 0===o||i>=e||i<0||d&&t-u>=a}function v(){var t=p();if(b(t))return y(t);h=setTimeout(v,function(t){var i=e-(t-o);return d?Q(i,a-(t-u)):i}(t))}function y(t){return h=void 0,g&&n?f(t):(n=r=void 0,s)}function T(){var t=p(),i=b(t);if(n=arguments,r=this,o=t,i){if(void 0===h)return function(t){return u=t,h=setTimeout(v,e),c?f(t):s}(o);if(d)return clearTimeout(h),h=setTimeout(v,e),f(o)}return void 0===h&&(h=setTimeout(v,e)),s}return e=P(e)||0,l(i)&&(c=!!i.leading,a=(d="maxWait"in i)?Y(P(i.maxWait)||0,e):a,g="trailing"in i?!!i.trailing:g),T.cancel=function(){void 0!==h&&clearTimeout(h),u=0,n=o=r=h=void 0},T.flush=function(){return void 0===h?s:y(p())},T},U="Expected a function";var L=function(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new TypeError(U);return l(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),F(t,e,{leading:n,maxWait:e,trailing:r})},z=function(t){function n(t){e(this,n);var i=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));Object.assign(i.setting,t);var r=i.setting.active,s=i.setting.text||"",h=i.setting.background,o=r.background,u=void 0;if(Tiny.isUndefined(h)&&(h=i.setting.blankBase64),Tiny.isString(h)){var l=Tiny.BaseTexture.from(h),c=new Tiny.Texture(l);h=new Tiny.Sprite(c),Tiny.BaseTexture.removeFromCache(l)}if(Tiny.isString(o)){var d=Tiny.BaseTexture.from(o);u=new Tiny.Texture(d),Tiny.BaseTexture.removeFromCache(d)}return i.addChild(h),Tiny.isString(s)&&(s=new Tiny.Text(s,i.setting.textStyle)),i.addChild(s),i.text=s,i.background=h,i.buttonMode=!0,h instanceof Tiny.Graphics||h.texture.baseTexture.hasLoaded?i.updatePosition():h.texture.on("update",function(){i.updatePosition(),i.emit("rendered")}),i.bindEvent(r,u),i}return r(n,u),i(n,[{key:"bindEvent",value:function(t,e){var i=this,n=this.setting.improveScrollExperience,r=this.background,a=r.texture,s=this.getOpacity(),h=this.getScale().x,o=this.getScale().y,u=function(){e&&(r.texture=a),t.opacity&&i.setOpacity(s),t.scale&&i.setScale(h,o)};if(this.on("pointerdown",function(n){if(e&&(r.texture=e),t.opacity&&i.setOpacity(t.opacity),t.scale){var a=t.scale;Tiny.isNumber(a)&&(a={scaleX:a,scaleY:a}),i.setScale(a.scaleX,a.scaleY)}}),this.on("pointerup",u),this.on("pointermove",function(t){}),this.on("pointerupoutside",u),n){var l=null,c=null,d=null,g=null,f=null,p=function(){d=null,g=null,l=null,c=null,f=null},b=L(function(t){var e=t.data.global,i=e.x,n=e.y,r=Math.sqrt((l-i)*(l-i)+(c-n)*(c-n)),a=Math.sqrt((d-i)*(d-i)+(g-n)*(g-n));d=i,g=n,(r>20||a>20)&&(f=!0)},30);this.on("pointerdown",function(t){var e=t.data.global,i=e.x,n=e.y;l=d=i,c=g=n,f=!1}),this.on("pointermove",b),this.on("pointerupoutside",p),this.on("pointerup",function(e){e.data.originalEvent.preventDefault(),!1===f&&function(){Tiny.isFunction(t.callback)&&t.callback(e)}(),p()})}else{var v=L(function(e){e.data.originalEvent.preventDefault(),Tiny.isFunction(t.callback)&&t.callback(e)},500,{trailing:!1});this.on("pointerup",v)}}},{key:"updatePosition",value:function(t){var e=void 0,i=void 0,n=~~this.setting.width,r=~~this.setting.height,a=t||this.setting.textPosition;this.background instanceof Tiny.Graphics||(this.background.width=n||this.background.texture.width,this.background.height=r||this.background.texture.height);var s=this.background.width-this.text.width,h=this.background.height-this.text.height;switch(a){case 1:e=0,i=0;break;case 2:e=s/2,i=0;break;case 3:e=s,i=0;break;case 4:e=0,i=h/2;break;case 6:e=s,i=h/2;break;case 7:e=0,i=h;break;case 8:e=s/2,i=h;break;case 9:e=s,i=h;break;default:e=s/2,i=h/2}this.text.setPosition(e,i)}},{key:"value",get:function(){return this.text.text},set:function(t){this.text&&(this.text.text=t,this.updatePosition())}}]),n}(),V=function(t){function n(t){e(this,n);var i=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));Object.assign(i.setting,t);var r=i.setting.html,s=i.setting.defs;return i.sprite=null,i._parseHTML(r,s,!1),i}return r(n,o),i(n,[{key:"updateHTML",value:function(t,e){this._parseHTML(t,e,!0)}},{key:"_parseHTML",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments[2],n=this,r=function(t){var e=document.createElement("template"),i=document.createElement("span");e.innerHTML=t,document.body.appendChild(i),e.content?i.appendChild(e.content,i.lastElementChild):i.insertAdjacentHTML("beforeend",t);i.style.position="absolute",i.style.zIndex="-1",i.style.display="block";var n=function(t){var e=void 0,i=[t.offsetWidth,t.offsetHeight];i[0]||("none"===(e=t.style).display?(e.display="block",i=[t.offsetWidth,t.offsetHeight],e.display="none"):""===e.display&&(e.display="block",i=[t.offsetWidth,t.offsetHeight],e.display=""));return i}(i),r={width:n[0],height:n[1]};return i.parentNode.removeChild(i),r}(t),a=~~this.setting.width||r.width,s=~~this.setting.height||r.height,h=new Blob(['\n    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+a+'" height="'+s+'">\n      <foreignObject width="100%" height="100%">\n        '+e+'\n        <div xmlns="http://www.w3.org/1999/xhtml">'+t+"</div>\n      </foreignObject>\n    </svg>\n    "],{type:"image/svg+xml;charset=utf-8"}),o=new FileReader;o.onload=function(){var t=Tiny.Texture.fromImage(this.result);i?n.sprite.texture=t:(n.sprite=new Tiny.Sprite(t),n.addChild(n.sprite)),n.sprite.texture.on("update",function(){n.emit("rendered")})},o.readAsDataURL(h)}}]),n}();var J=function(t){function s(t){e(this,s);var i=a(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));return i.defaultSetting={text:"",width:0,height:0},i.settings=Object.assign({},i.defaultSetting,t||{}),i.render(),i}return r(s,u),i(s,[{key:"render",value:function(){var t=this.settings,e=t.text,i=t.width,r=t.height,a=(t.wordWrap,t.breakWords,t.wordWrapWidth,function(t,e){var i={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i}(t,["text","width","height","wordWrap","breakWords","wordWrapWidth"])),s=n({wordWrap:!!i,breakWords:!!i,wordWrapWidth:i},a);if(this.text=new Tiny.Text(e,s),r&&i){var h=new Tiny.Graphics;h.lineStyle(0),h.beginFill(16777215),h.drawRect(0,0,i,r),h.endFill(),this.mask=h}this.addChild(this.text)}}]),s}(),X=function(t){function n(t,i,r,s){var h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;e(this,n);var o=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return o._gridTexture=t,o._debugDraw=!1,o._textures=[],o._gridSprites=[],o._targetWidth=i||0,o._targetHeight=r||0,o._textureOrigFrame=new Tiny.Rectangle(0,0,o._gridTexture.width,o._gridTexture.height),o._scale9Grid=null,o._overlapPadding=h,o._inited=!1,o.scale9Grid=s,o._gridTexture.baseTexture.hasLoaded?o._onGridTextureUpdate():o._gridTexture.once("update",o._onGridTextureUpdate,o),o}return r(n,o),i(n,[{key:"_onGridTextureUpdate",value:function(){this._init(),this._update()}},{key:"_init",value:function(){if(!this._inited){this._inited=!0;for(var t=0;t<9;t++){var e=new Tiny.Texture(this._gridTexture,this._gridTexture.frame,this._gridTexture.orig,null,0);this._textures.push(e);var i=new Tiny.Sprite(e);i.visible=!1,this._gridSprites.push(i),this.addChild(i)}}}},{key:"resize",value:function(t,e){this._targetWidth=t,this._targetHeight=e,this._update(t,e)}},{key:"offsetFrame",value:function(t,e,i){return[(this._textures[t].frame.x||0)+e,(this._textures[t].frame.y||0)+i]}},{key:"_update",value:function(){if(this._gridTexture&&this._gridTexture.baseTexture.hasLoaded&&this._inited){(this.width<this._gridTexture.width||this.height<this._gridTexture.height)&&console.warn("九宫格尺寸设置异常，尺寸不能小于素材尺寸");for(var t=Math.max(this.width,this._gridTexture.width),e=Math.max(this.height,this._gridTexture.height),i=this._scale9Grid,n=i[0],r=Math.max(0,i[2]),a=Math.max(0,this._gridTexture.width-n-r),h=i[1],o=Math.max(0,i[3]),u=[n,r,a],l=[0,n,n+r],c=[h,o,Math.max(0,this._gridTexture.height-h-o)],d=[0,h,h+o],g=this.overlapPadding,f=0;f<3;f++)for(var p=0;p<3;p++){var b=3*f+p,v=this._gridSprites[b],y=new(Function.prototype.bind.apply(Tiny.Rectangle,[null].concat(s(this.offsetFrame(b,l[p],d[f])),[u[p],c[f]])));if(y.width>0&&y.height>0){var T=0===p||2===p?u[p]:Math.max(0,t-u[0]-u[2]),A=0===f||2===f?c[f]:Math.max(0,e-c[0]-c[2]),m=0===p?0:1===p?u[0]:Math.max(0,t-u[2]),I=0===f?0:1===f?c[0]:Math.max(0,e-c[2]);T>0&&A>0?(this._textures[b].frame=y,v.anchor.set(0,0),v.x=m-p*g,v.y=I-f*g,v.alpha=this._debugDraw?.1+.05*b:1,v.width=T,v.height=A,v.visible=!0):v.visible=!1}else v.visible=!1}this.emit("resize")}}},{key:"debug",get:function(){return this._debugDraw},set:function(t){this._debugDraw=t,this._update()}},{key:"scale9Grid",get:function(){return this._scale9Grid},set:function(t){if(t){var e="string"==typeof t?t.split(","):t;if(4!==e.length)return void console.error("error scale9Grid format",t);e=e.map(function(t){return parseFloat(t)}),this._scale9Grid=e}else this._scale9Grid=[0,0,0,0];this._update()}},{key:"width",get:function(){return this._targetWidth||this._gridTexture.width},set:function(t){this._targetWidth=t,this._update()}},{key:"height",get:function(){return this._targetHeight||this._gridTexture.height},set:function(t){this._targetHeight=t,this._update()}},{key:"overlapPadding",get:function(){return this._overlapPadding},set:function(t){this._overlapPadding=+t||0,this._update()}}]),n}(),K=function(t){function n(t,i){e(this,n);var r=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return r.stage=t&&t.stage||null,r.buttonText=i||"关闭",r.DPI=Tiny.config.dpi,r.PADDING=40*r.DPI,r.CONTENT_FONTSIZE=16*r.DPI,r.BTN_FONTSIZE=14*r.DPI,r.MIN_HEIGHT=50*r.DPI,r.MAX_WIDTH=.8*Tiny.WIN_SIZE.width,r}return r(n,u),i(n,[{key:"render",value:function(t){this.removeChildren(0,this.children.length),this.label=this.drawLabel(t),this.roundRect=this.drawRoundRect(),this.btn=this.drawButton(),this.updatePosition()}},{key:"drawLabel",value:function(t){var e=new J({text:t,fill:"0x333333",fontSize:this.CONTENT_FONTSIZE,width:this.MAX_WIDTH-this.PADDING});return this.addChild(e),e}},{key:"drawRoundRect",value:function(){var t=this.getLocalBounds().height,e=t>this.MIN_HEIGHT&&t+this.PADDING||this.MIN_HEIGHT+this.PADDING,i=Tiny.BaseTexture.from(this.setting.roundRectBase64_white),n=new Tiny.Texture(i),r=new X(n,this.MAX_WIDTH,e,[10,10,1,1]);return Tiny.BaseTexture.removeFromCache(i),this.addChild(r),r}},{key:"drawButton",value:function(){var t=this,e=new z({text:this.buttonText,textStyle:{fill:"0x108EE9",fontSize:this.BTN_FONTSIZE},active:{opacity:.5,callback:function(){t.stage&&t.stage.removeChild(t),t.callback&&t.callback()}}});return this.addChild(e),e}},{key:"updatePosition",value:function(){var t=this.roundRect,e=t.width,i=t.height,n=Tiny.WIN_SIZE;this.btn.setPosition(this.MAX_WIDTH-this.btn.width,i-this.btn.height),this.label.setPosition(this.MAX_WIDTH/2-this.label.width/2,i/2-this.label.height/2-5*this.DPI),this.setChildIndex(this.label,1),this.setPosition(n.width/2-e/2,n.height/2-i/2)}},{key:"alert",value:function(t,e){this.stage&&(this.stage.removeChild(this),this.render(t),this.stage.addChild(this),this.callback=e)}}]),n}(),q=function(t){function n(t,i){e(this,n);var r=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return r.stage=t&&t.stage||null,r.autoHideTime=i||2e3,r.DPI=Tiny.config.dpi,r.PADDING=20*r.DPI,r.CONTENT_FONTSIZE=16*r.DPI,r.MIN_HEIGHT=20*r.DPI,r.MAX_WIDTH=.4*Tiny.WIN_SIZE.width,r.MIN_WIDTH=.3*Tiny.WIN_SIZE.width,r.bindEvent(),r}return r(n,u),i(n,[{key:"bindEvent",value:function(){var t=this;this.on("pointerdown",function(e){t.stage&&t.stage.removeChild(t)})}},{key:"render",value:function(t){this.removeChildren(0,this.children.length),this.label=this.drawLabel(t),this.roundRect=this.drawRoundRect(),this.updatePosition()}},{key:"drawLabel",value:function(t){var e=new J({text:t,fill:"0xffffff",fontSize:this.CONTENT_FONTSIZE,width:this.MAX_WIDTH});return this.addChild(e),e}},{key:"drawRoundRect",value:function(){var t=this.getLocalBounds(),e=t.width,i=t.height,n=i>this.MIN_HEIGHT&&i+this.PADDING||this.MIN_HEIGHT+this.PADDING,r=this.PADDING;e>this.MAX_WIDTH?r+=this.MAX_WIDTH:e<this.MIN_WIDTH?r+=this.MIN_WIDTH:r+=e;var a=new X(Tiny.Sprite.fromImage(this.setting.roundRectBase64_black75).texture,r,n,[10,10,1,1],0);return this.addChild(a),a}},{key:"updatePosition",value:function(){var t=this.roundRect,e=t.width,i=t.height,n=Tiny.WIN_SIZE;this.label.setPosition(e/2-this.label.width/2,i/2-this.label.height/2),this.setChildIndex(this.label,1),this.setPosition(n.width/2-e/2,n.height/2-i/2)}},{key:"show",value:function(t){var e=this;if(this.stage){this.stage.removeChild(this),this.render(t),this.stage.addChild(this);var i=new Tiny.ticker.CountDown({duration:this.autoHideTime,times:1});i.on("complete",function(t){e.stage.children.length&&e.stage.removeChild(e),i.destroy()}),i.start()}}}]),n}(),$=function(){function t(i){e(this,t),this.matchup=i}return i(t,[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Tiny.Container,i=t.split(""),n=this.matchup,r=0;return i.forEach(function(t){var i=n[t];if(i){var a=new Tiny.Sprite(n[t]),s=i.width;a.setPositionX(r),r+=s,e.addChild(a)}}),this.container=e,e}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments[1];return e||(e=this.container?this.container:new Tiny.Container),e.removeChildren(),this.create.call(this,t,e),e}}]),t}(),tt=function(){function t(i,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;e(this,t),this.texts=Array.apply(null,Array(a)).map(function(){return" "}),this.container=i,this.length=a,this.count=0,this.sprites=[],this.textInstance=new Tiny.Text(this.texts.join("\n"),n,r),this.textInstance.setPositionX(Tiny.WIN_SIZE.width),this.textInstance.renderable=!1,i.addChild(this.textInstance)}return i(t,[{key:"create",value:function(t){var e=this,i=this.count,n=this.length;if(i>n)throw new RangeError("你创建的个数已超过预设值："+n);this.count++,this.texts[i]=t;var r=this._generateTexture(t,i),a=new Tiny.Sprite(r);return this.sprites.push(a),this._update(),a.textIndex=i,a.updateText=function(t){e._updateText(t,a),e._update()},a}},{key:"_update",value:function(){this.sprites.forEach(function(t){t.texture._updateUvs()})}},{key:"_generateTexture",value:function(t,e){var i=this.length,n=this.textInstance;n.text=this.texts.join("\n");var r=n.texture.baseTexture,a=n.width,s=n.height/i,h=s*e;return new Tiny.Texture(r,new Tiny.Rectangle(0,h,a,s))}},{key:"_updateText",value:function(t,e){var i=e.textIndex;this.texts[i]=t;var n=this._generateTexture(t,i);e.texture=n}}]),t}(),et=function(t){function n(t){e(this,n);var i=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t=t||{},i.itemsAlign=t.itemsAlign||"middle",i.items=[],i.spliceItems(0,0,t.items),i}return r(n,t),i(n,[{key:"layout",value:function(){var t=this,e=this.maxHeight;this.items.reduce(function(i,n){var r=n.displayObj,a=0,s=i+(Number(n.leftMargin)||0);switch(t.itemsAlign){case"top":break;case"bottom":a=e-r.height;break;default:a=(e-r.height)/2}return r.setPosition(s,a),s+r.width+(Number(n.rightMargin)||0)},0)}},{key:"deleteItem",value:function(t){var e=this.items.findIndex(function(e){return e.displayObj===t});-1!==e&&(this.items.splice(e,1),this.removeChild(t),this.layout())}},{key:"spliceItems",value:function(t,e,i){var n,r=this,a=(i||[]).filter(function(t){var e=t.displayObj;return e instanceof Tiny.DisplayObject&&(r.addChild(e),!0)});(n=this.items).splice.apply(n,[t,e].concat(s(a))).forEach(function(t){r.removeChild(t.displayObj)}),this.layout()}},{key:"maxHeight",get:function(){var t=0;return this.items.forEach(function(e){e.displayObj.height>t&&(t=e.displayObj.height)}),t}}]),n}(Tiny.Container);t.Button=z,t.DOM=V,t.Label=J,t.Alert=K,t.NinePatch=X,t.Toast=q,t.ImageNumber=$,t.TiledText=tt,t.InlineItems=et,Object.defineProperty(t,"__esModule",{value:!0})});
